branches:
  only: [master]

environment:
  matrix:
    - nodejs_version: "18"
  NODE_OPTIONS: "--max-old-space-size=4096"

install:
  - ps: Install-Product node $env:nodejs_version
  - node --version
  - npm --version
  - npm ci --ignore-scripts
  - npx --no lerna bootstrap

test_script:
  - node packages/build/bin/compile-package -b
  - node packages/build/bin/run-mocha --lang en_US.UTF-8 --reporter spec "packages/*/dist/__tests__/**/*.js" "packages/{build,cli}/test/**/*.js" "extensions/*/dist/__tests__/**/*.js" "examples/*/dist/__tests__/**/*.js"

cache:
  - "%LOCALAPPDATA%\\Yarn"

build: off
