# @loopback/apiconnect

This module extends LoopBack with the ability to integrate with
[IBM API Connect](https://www.ibm.com/cloud/api-connect). It comes with an
`ApiConnectComponent` that adds an `OASEnhancer` extension to contribute
`x-ibm-configuration` to the OpenAPI spec generated by LoopBack applications. It
also provides complete TypeScript definitions for all API Connect OpenAPI 3.0
extensions.

## Stability: ⚠️Experimental⚠️

> Experimental packages provide early access to advanced or experimental
> functionality to get community feedback. Such modules are published to npm
> using `0.x.y` versions. Their APIs and functionality may be subject to
> breaking changes in future releases.

## Installation

```sh
npm i @loopback/apiconnect --save
```

## Usage

The component should be loaded in the constructor of your custom Application
class.

Start by importing the component class:

```ts
import {ApiConnectComponent} from '@loopback/apiconnect';
```

In the constructor, add the component to your application:

```ts
this.component(ApiConnectComponent);
```

The component requires a configuration for API Connect extension for OpenAPI
spec. The `targetUrl` tells API Connect gateway where the REST APIs are served.

```ts
const apiConnectOptions: ApiConnectSpecOptions = {
  targetUrl: 'http://localhost:3000/test-service',
};
app
  .configure(ApiConnectBindings.API_CONNECT_SPEC_ENHANCER)
  .to(apiConnectOptions);
```

### API Connect OpenAPI 3.0 Extensions

This package provides versioned TypeScript type definitions for API Connect
OpenAPI 3.0 extensions. They are provided as an extended OpenAPI 3.0 object
(Useful for writing raw OpenAPI 3.0 specifications), and as individual or
grouped, versioned policies.

To write an OpenAPI 3.0 specification with the API Connect extensions:

```typescript
import {APIConnectOASObjects} from '@loopback/apiconnect';

const myOASSpec: APIConnectOASObjects.OpenAPIObject = {
  {
    openapi: '3.0.0',
    info: {
      title: 'LoopBack Project',
      version: '1.0.0',
      'x-ibm-name': 'LoopBack Project',
    },
    paths: {},
    servers: [{url: '/'}],
    'x-ibm-configuration': {
      assembly: {
        execute: [
          {
            invoke: {
              title: 'invoke',
              version: '2.0.0',
              'target-url': 'https://api.example.com',
            },
          },
        ],
      },
      cors: {
        enabled: true,
      },
      enforced: true,
      phase: 'realized',
      testable: true,
      gateway: 'datapower-api-gateway',
    },
}
```

## Contributions

- [Guidelines](https://github.com/loopbackio/loopback-next/blob/master/docs/CONTRIBUTING.md)
- [Join the team](https://github.com/loopbackio/loopback-next/issues/110)

## Tests

Run `npm test` from the root folder.

## Contributors

See
[all contributors](https://github.com/loopbackio/loopback-next/graphs/contributors).

## License

MIT
